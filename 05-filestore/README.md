# LetoCTF Taskbot 2022 | 05-filestore

Автор: [zarix908](https://github.com/zarix908)

## Информация

Залил файл в одно интересное хранилище, но забыл пароль для входа, не поможешь? Файл называется `flag.enc`.

## Описание

Сервис представляет собой простое файловое хранилище. В него можно загружать как обычные файлы так и зашифрованные. Для шифрования используется алгоритм blowfish. Алгоритм реализован в подгружаемом WASM модуле. В качестве ключа шифрования используется идентификатор владельца файла.

## Решение

Исследуя приложение (например на вкладке networks в браузере или в wireshark-e), можно обнаружить, что при загрузке зашифрованного файла подгружается WASM модуль `cipher.wasm`, с помощью которого и осуществляется шифрование. Разреверсив модуль, можно понять как работает алгоритм и написать обратный к нему (дешифрование) или найти, что wasm модуль реализует шифрование blowfish (например по вшитой константе 4168) в little endian порядке. Из исходного кода фронтенда, видно, что в качестве ключа шифрования используется идентификатор пользователя. Через методы API необходимо получить зашифрованный файл (`/api/get?filename=flag.enc`) и его владельца (`/api/owner?filename=flag.enc`), а затем расшифровать алгоритмом blowfish в порядке little endian.

## Флаг

`LetoCTF{bl0uF1sH_YEt_aNotth3r_crypt0_alg}`
